{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Dashboard do Instrutor</title>
    <link rel="stylesheet" href="{% static 'css/base.css' %}">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100 min-h-screen flex flex-col">
<header class="bg-blue-900 text-white py-4 shadow">
    <div class="max-w-7xl mx-auto px-4 flex justify-between items-center">
        <h1 class="text-2xl font-bold">ðŸŽ“ Painel do Instrutor</h1>
        <form method="post" action="{% url 'logout' %}">
            {% csrf_token %}
            <button class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded">Logout</button>
        </form>
    </div>
</header>

<main class="flex-grow py-8 px-4 max-w-7xl mx-auto">
    <h2 class="text-xl font-semibold mb-6">ðŸ‘¥ Alunos Vinculados</h2>

    {% if error %}
        <p class="text-red-600 mb-4">{{ error }} <br> {{ exception }}</p>
    {% else %}
        {% if alunos %}
        <div class="overflow-x-auto bg-white shadow-md rounded-lg">
            <table class="min-w-full text-left text-sm text-gray-700">
                <thead class="bg-gray-100 text-xs uppercase text-gray-600">
                    <tr>
                        <th class="px-6 py-3">CÃ³digo aluno</th>
                        <th class="px-6 py-3">Nome</th>
                        <th class="px-6 py-3">Email</th>
                        <th class="px-6 py-3">Telefone</th>
                        <th class="px-6 py-3 text-center">AÃ§Ãµes</th>
                    </tr>
                </thead>
                <tbody>
                    {% for aluno in alunos %}
                    <tr class="border-b hover:bg-gray-50">
                        <td class="px-6 py-4 font-medium">{{ aluno.cod_aluno }}</td>
                        <td class="px-6 py-4 font-medium">{{ aluno.nome }}</td>
                        <td class="px-6 py-4">{{ aluno.email }}</td>
                        <td class="px-6 py-4">{{ aluno.telefone }}</td>
                        <td class="px-6 py-4 text-center">
                            <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#modalTreino{{ aluno.cod_aluno }}">
                                âž• Adicionar Treino
                            </button>

                            <!-- Modal -->
                            <div class="modal fade" id="modalTreino{{ aluno.cod_aluno }}" tabindex="-1" aria-labelledby="modalTreinoLabel{{ aluno.cod_aluno }}" aria-hidden="true">
                              <div class="modal-dialog modal-lg">
                                <div class="modal-content">
                                  <form method="post" action="{% url 'adicionar_treino' %}">
                                    {% csrf_token %}
                                    <div class="modal-header">
                                      <h5 class="modal-title">Novo Treino - {{ aluno.nome }}</h5>
                                      <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                    </div>

                                    <div class="modal-body row">
                                      <div class="col-md-6">

                                        <label>CÃ³digo do Instrutor</label>
                                        <input type="text" name="cod_instrutor" class="form-control" value="{{ cod_instrutor }}" required>

                                        <label>CÃ³digo do Aluno</label>
                                        <input type="text" name="cod_aluno" class="form-control" value="{{ aluno.cod_aluno }}" required>

                                        <label>Tipo de Treino</label>
                                        <input name="tipo_treino" class="form-control" required>

                                        <label>Objetivo</label>
                                        <input name="objetivo" class="form-control">

                                        <label>ObservaÃ§Ãµes</label>
                                        <textarea name="observacoes" class="form-control"></textarea>

                                        <label>Data InÃ­cio</label>
                                        <input type="date" name="data_inicio" class="form-control" required>

                                        <label>Data Final</label>
                                        <input type="date" name="data_final" class="form-control" required>
                                      </div>

                                      <div class="col-md-6">
                                        <label>Nome do ExercÃ­cio</label>
                                        <input name="nome_exercicio" class="form-control" required>

                                        <label>Tipo de ExercÃ­cio</label>
                                        <input name="tipo_exercicio" class="form-control" required>

                                        <label>DescriÃ§Ã£o do ExercÃ­cio</label>
                                        <textarea name="descricao_exercicio" class="form-control"></textarea>
                                      </div>
                                    </div>

                                    <div class="modal-footer">
                                      <button type="submit" class="btn btn-success">Salvar Treino</button>
                                    </div>
                                  </form>
                                </div>
                              </div>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <p class="text-gray-500">Nenhum aluno vinculado ao instrutor.</p>
        {% endif %}
    {% endif %}
</main>

<footer class="bg-white border-t py-4 mt-auto">
    <div class="text-center text-sm text-gray-500">
        Â© {{ year|default:"2025" }} ERPWAY SYSTEM â€” Painel do Instrutor
    </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
