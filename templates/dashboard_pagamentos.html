<div class="card p-6">
    <div class="flex justify-between items-center mb-6">
        <h2 class="text-xl font-bold text-gray-900">Pagamentos de {{ aluno.nome }}</h2>
        <button onclick="document.getElementById('modalPagamento').classList.remove('hidden')"
            class="text-sm text-primary-600 hover:text-primary-800">
            Novo Pagamento
        </button>
        <form method="get" action="{% url 'atualizar_status_pagamento' payment_id=115850362334 
         %}">
    <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded">Atualizar Status</button>
</form>
    </div>

    <div class="overflow-x-auto">
        <table class="min-w-full bg-white rounded-lg">
            <thead class="bg-gray-50">
                <tr>
                    <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Data</th>
                    <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Valor</th>
                    <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Status</th>
                    <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">AÃ§Ã£o</th>
                </tr>
            </thead>
            <tbody class="divide-y divide-gray-100">
                {% for pagamento in pagamentos %}
                <tr>
                    <td class="px-4 py-3 text-sm">{{ pagamento.criado_em|date:"d/m/Y H:i" }}</td>
                    <td class="px-4 py-3 text-sm">R$ {{ pagamento.valor }}</td>
                    <td class="px-4 py-3 text-sm">
                        <span
                            class="px-2 py-1 {% if pagamento.status == 'approved' %}bg-green-100 text-green-800{% else %}bg-yellow-100 text-yellow-800{% endif %} text-xs rounded-full">
                            {{ pagamento.status|upper }}
                        </span>
                    </td>
                    <td class="px-4 py-3 text-sm">
                    {% if pagamento.status != "approved" %}
                        <form method="get" action="{% url 'atualizar_status_pagamento' payment_id=pagamento.mp_payment_id %}">
                        <input type="hidden" name="cod_aluno" value="{{ cod_aluno }}">
                        <button type="submit" class="text-indigo-600 hover:underline text-xs">
                            Atualizar
                        </button>
                        </form>
                    {% else %}
                        <span class="text-green-600 text-xs">âœ”</span>
                    {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<!-- ðŸ”¥ Modal de Pagamento -->
<div id="modalPagamento"
    class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    {% include 'pagamento_form.html' %}
</div>
