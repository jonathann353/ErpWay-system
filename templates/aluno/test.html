{% load static %}

{% block style %}
<link rel="stylesheet" href="{% static 'css/base.css' %}">
<link rel="stylesheet" href="{% static 'css/aluno.css' %}">
<script src="https://cdn.tailwindcss.com"></script>
<script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
<script src="https://code.highcharts.com/highcharts.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
    
    :root {
        --primary: #4f46e5;
        --primary-light: #6366f1;
        --secondary: #10b981;
        --accent: #f59e0b;
        --dark: #1e293b;
        --light: #f8fafc;
    }
    
    body {
        font-family: 'Inter', sans-serif;
        background-color: var(--light);
    }
    
    .sidebar-link {
        position: relative;
        transition: all 0.3s ease;
    }
    
    .sidebar-link::after {
        content: '';
        position: absolute;
        left: 0;
        top: 0;
        height: 100%;
        width: 4px;
        background: var(--primary);
        transform: translateX(-100%);
        transition: transform 0.3s ease;
    }
    
    .sidebar-link:hover::after,
    .sidebar-link.active::after {
        transform: translateX(0);
    }
    
    .card-hover {
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    
    .card-hover:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
    }
    
    .scrollbar-thin::-webkit-scrollbar {
        width: 6px;
        height: 6px;
    }
    
    .scrollbar-thin::-webkit-scrollbar-thumb {
        background: #cbd5e1;
        border-radius: 3px;
    }
    
    .animate-float {
        animation: float 3s ease-in-out infinite;
    }
    
    @keyframes float {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-5px); }
    }
    
    .status-badge {
        font-size: 0.75rem;
        padding: 0.25rem 0.75rem;
        border-radius: 9999px;
    }
    
    .status-active {
        background-color: #d1fae5;
        color: #065f46;
    }
    
    .status-inactive {
        background-color: #fee2e2;
        color: #991b1b;
    }
</style>
{% endblock style %}

{% block content %}
<div x-data="{ sidebarOpen: false, darkMode: false }" :class="{ 'dark': darkMode }" class="min-h-screen bg-gray-50 dark:bg-gray-900">
    <!-- Dark Mode Toggle -->
    <button @click="darkMode = !darkMode" class="fixed bottom-6 right-6 z-50 w-12 h-12 rounded-full bg-indigo-600 shadow-lg flex items-center justify-center text-white hover:bg-indigo-700 transition-colors">
        <i x-show="!darkMode" class="fas fa-moon"></i>
        <i x-show="darkMode" class="fas fa-sun"></i>
    </button>

    <!-- Mobile Sidebar Overlay -->
    <div x-show="sidebarOpen" @click="sidebarOpen = false" 
         class="fixed inset-0 z-20 bg-black/50 lg:hidden transition-opacity duration-300"
         x-transition:enter="ease-out duration-300"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         x-transition:leave="ease-in duration-200"
         x-transition:leave-start="opacity-100"
         x-transition:leave-end="opacity-0">
    </div>

    <!-- Sidebar -->
    <aside :class="sidebarOpen ? 'translate-x-0' : '-translate-x-full lg:translate-x-0'"
           class="fixed inset-y-0 left-0 z-30 w-72 bg-white dark:bg-gray-800 shadow-xl transition-transform duration-300 ease-in-out lg:static lg:inset-0">
        <div class="flex flex-col h-full">
            <!-- Logo -->
            <div class="flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 rounded-lg bg-indigo-600 flex items-center justify-center text-white">
                        <i class="fas fa-dumbbell text-xl"></i>
                    </div>
                    <span class="text-xl font-bold text-gray-800 dark:text-white">ERPWAY</span>
                </div>
                <button @click="sidebarOpen = false" class="text-gray-500 dark:text-gray-400 lg:hidden">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <!-- User Profile -->
            <div class="p-6 border-b border-gray-200 dark:border-gray-700">
                <div class="flex items-center space-x-4">
                    <div class="w-12 h-12 rounded-full bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center text-indigo-600 dark:text-indigo-300">
                        <i class="fas fa-user text-xl"></i>
                    </div>
                    <div>
                        <h4 class="font-medium text-gray-800 dark:text-white">
                            {% if user.is_authenticated %}
                            {{ user.username }}
                            {% else %}
                            Visitante
                            {% endif %}
                        </h4>
                        <span class="text-sm text-gray-500 dark:text-gray-400">Administrador</span>
                    </div>
                </div>
            </div>

            <!-- Navigation -->
            <nav class="flex-1 p-4 overflow-y-auto">
                <ul class="space-y-2">
                    <li>
                        <a href="{% url 'dashboard' %}" 
                           class="sidebar-link flex items-center p-3 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors active">
                            <i class="fas fa-tachometer-alt mr-3 text-indigo-600"></i>
                            <span>Dashboard</span>
                        </a>
                    </li>
                    <li>
                        <a href="../instrutores" 
                           class="sidebar-link flex items-center p-3 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                            <i class="fas fa-chalkboard-teacher mr-3 text-blue-500"></i>
                            <span>Instrutores</span>
                        </a>
                    </li>
                    <li>
                        <a href="../test" 
                           class="sidebar-link flex items-center p-3 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                            <i class="fas fa-users mr-3 text-emerald-500"></i>
                            <span>Alunos</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" 
                           class="sidebar-link flex items-center p-3 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                            <i class="fas fa-file-alt mr-3 text-purple-500"></i>
                            <span>Formulários</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" 
                           class="sidebar-link flex items-center p-3 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                            <i class="fas fa-calendar-alt mr-3 text-amber-500"></i>
                            <span>Agendamentos</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" 
                           class="sidebar-link flex items-center p-3 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                            <i class="fas fa-chart-line mr-3 text-red-500"></i>
                            <span>Relatórios</span>
                        </a>
                    </li>
                </ul>
            </nav>

            <!-- Logout -->
            <div class="p-4 border-t border-gray-200 dark:border-gray-700">
                <form method="post" action="{% url 'logout' %}">
                    {% csrf_token %}
                    <button type="submit" class="w-full flex items-center justify-center p-3 rounded-lg bg-red-500 text-white hover:bg-red-600 transition-colors">
                        <i class="fas fa-sign-out-alt mr-2"></i>
                        <span>Sair</span>
                    </button>
                </form>
            </div>
        </div>
    </aside>

    <!-- Main Content -->
    <div class="lg:ml-72">
        <!-- Header -->
        <header class="bg-white dark:bg-gray-800 shadow-sm sticky top-0 z-10">
            <div class="flex items-center justify-between px-6 py-4">
                <div class="flex items-center">
                    <button @click="sidebarOpen = true" class="text-gray-500 dark:text-gray-400 focus:outline-none lg:hidden mr-4">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                    <h1 class="text-xl font-semibold text-gray-800 dark:text-white">Dashboard Principal</h1>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="relative">
                        <button class="text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-white">
                            <i class="fas fa-bell text-xl"></i>
                            <span class="absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full"></span>
                        </button>
                    </div>
                    <div class="relative">
                        <button class="text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-white">
                            <i class="fas fa-envelope text-xl"></i>
                            <span class="absolute top-0 right-0 w-2 h-2 bg-blue-500 rounded-full"></span>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content Area -->
        <main class="p-6">
            <!-- Welcome Banner -->
            <div class="bg-gradient-to-r from-indigo-600 to-blue-500 rounded-xl p-6 mb-6 text-white shadow-lg">
                <div class="flex flex-col md:flex-row items-center justify-between">
                    <div>
                        <h2 class="text-2xl font-bold mb-2">Bem-vindo de volta, {% if user.is_authenticated %}{{ user.username }}{% else %}Visitante{% endif %}!</h2>
                        <p class="opacity-90">Aqui está o resumo das atividades recentes da sua academia.</p>
                    </div>
                    <div class="mt-4 md:mt-0">
                        <button class="bg-white text-indigo-600 px-4 py-2 rounded-lg font-medium hover:bg-opacity-90 transition">
                            Ver relatório completo
                        </button>
                    </div>
                </div>
            </div>

            <!-- Stats Cards -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <!-- Active Students -->
                <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm card-hover">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Alunos Ativos</p>
                            <h3 class="text-3xl font-bold mt-2 text-gray-800 dark:text-white">{{ total_alunos }}</h3>
                            <p class="text-sm text-emerald-500 mt-1 flex items-center">
                                <i class="fas fa-arrow-up mr-1"></i> 12% desde o último mês
                            </p>
                        </div>
                        <div class="p-3 bg-emerald-100 dark:bg-emerald-900/30 rounded-full text-emerald-600 dark:text-emerald-400">
                            <i class="fas fa-user-check text-xl"></i>
                        </div>
                    </div>
                </div>

                <!-- Inactive Students -->
                <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm card-hover">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Alunos Inativos</p>
                            <h3 class="text-3xl font-bold mt-2 text-gray-800 dark:text-white">{{ total_inativos }}</h3>
                            <p class="text-sm text-red-500 mt-1 flex items-center">
                                <i class="fas fa-arrow-down mr-1"></i> 5% desde o último mês
                            </p>
                        </div>
                        <div class="p-3 bg-red-100 dark:bg-red-900/30 rounded-full text-red-600 dark:text-red-400">
                            <i class="fas fa-user-slash text-xl"></i>
                        </div>
                    </div>
                </div>

                <!-- Monthly Revenue -->
                <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm card-hover">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Faturamento</p>
                            <h3 class="text-3xl font-bold mt-2 text-gray-800 dark:text-white">R$ {{ soma_valores|floatformat:2 }}</h3>
                            <p class="text-sm text-blue-500 mt-1 flex items-center">
                                <i class="fas fa-arrow-up mr-1"></i> 8% desde o último mês
                            </p>
                        </div>
                        <div class="p-3 bg-blue-100 dark:bg-blue-900/30 rounded-full text-blue-600 dark:text-blue-400">
                            <i class="fas fa-dollar-sign text-xl"></i>
                        </div>
                    </div>
                </div>

                <!-- Last Payment -->
                <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm card-hover">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Último Pagamento</p>
                            <h3 class="text-3xl font-bold mt-2 text-gray-800 dark:text-white">R$ {{ ultimo_pagamento|floatformat:2 }}</h3>
                            <p class="text-sm text-amber-500 mt-1 flex items-center">
                                <i class="fas fa-clock mr-1"></i> Hoje às 14:30
                            </p>
                        </div>
                        <div class="p-3 bg-amber-100 dark:bg-amber-900/30 rounded-full text-amber-600 dark:text-amber-400">
                            <i class="fas fa-receipt text-xl"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Charts and Activity Section -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
                <!-- Student Distribution Chart -->
                <div class="lg:col-span-2 bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Distribuição de Alunos</h3>
                        <div class="flex space-x-2">
                            <button class="px-3 py-1 text-sm bg-indigo-100 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-300 rounded-lg">Mensal</button>
                            <button class="px-3 py-1 text-sm bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 rounded-lg">Anual</button>
                        </div>
                    </div>
                    <div class="h-64">
                        <canvas id="statusChart"></canvas>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm">
                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-6">Atividades Recentes</h3>
                    <div class="space-y-4">
                        <div class="flex items-start">
                            <div class="p-2 bg-emerald-100 dark:bg-emerald-900/30 rounded-lg text-emerald-600 dark:text-emerald-400 mr-3">
                                <i class="fas fa-user-plus"></i>
                            </div>
                            <div>
                                <p class="font-medium text-gray-800 dark:text-white">Novo aluno cadastrado</p>
                                <p class="text-sm text-gray-500 dark:text-gray-400">João Silva acabou de se matricular</p>
                                <p class="text-xs text-gray-400 dark:text-gray-500 mt-1">2 minutos atrás</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <div class="p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg text-blue-600 dark:text-blue-400 mr-3">
                                <i class="fas fa-dollar-sign"></i>
                            </div>
                            <div>
                                <p class="font-medium text-gray-800 dark:text-white">Pagamento recebido</p>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Maria Oliveira pagou mensalidade</p>
                                <p class="text-xs text-gray-400 dark:text-gray-500 mt-1">1 hora atrás</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <div class="p-2 bg-purple-100 dark:bg-purple-900/30 rounded-lg text-purple-600 dark:text-purple-400 mr-3">
                                <i class="fas fa-calendar-check"></i>
                            </div>
                            <div>
                                <p class="font-medium text-gray-800 dark:text-white">Aula agendada</p>
                                <p class="text-sm text-gray-500 dark:text-gray-400">Carlos marcou aula com instrutor</p>
                                <p class="text-xs text-gray-400 dark:text-gray-500 mt-1">3 horas atrás</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <div class="p-2 bg-amber-100 dark:bg-amber-900/30 rounded-lg text-amber-600 dark:text-amber-400 mr-3">
                                <i class="fas fa-exclamation-circle"></i> </div> <div> <p class="font-medium text-gray-800 dark:text-white">Aluno inativo</p> <p class="text-sm text-gray-500 dark:text-gray-400">Ana Rodrigues está há 30 dias sem treinar</p> <p class="text-xs text-gray-400 dark:text-gray-500 mt-1">Ontem</p> </div> </div> </div> </div> </div>

        <!-- Revenue Chart and Quick Actions -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
            <!-- Revenue Chart -->
            <div class="lg:col-span-2 bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-lg font-semibold text-gray-800 dark:text-white">Faturamento Mensal</h3>
                    <select class="bg-gray-100 dark:bg-gray-700 border-none text-gray-700 dark:text-gray-300 rounded-lg px-3 py-1 text-sm">
                        <option>Últimos 6 meses</option>
                        <option>Últimos 12 meses</option>
                        <option>Este ano</option>
                    </select>
                </div>
                <div class="h-64">
                    <canvas id="faturamentoChart"></canvas>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm">
                <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-6">Ações Rápidas</h3>
                <div class="grid grid-cols-1 gap-3">
                    <button onclick="openModal('modalAluno')"
                        class="flex items-center justify-center px-4 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors duration-200 text-sm font-medium">
                        <i class="fas fa-user-plus mr-2"></i>Cadastrar Novo Aluno
                    </button>
                    <button
                        class="flex items-center justify-center px-4 py-3 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors duration-200 text-sm font-medium">
                        <i class="fas fa-file-alt mr-2"></i>Emitir Relatório
                    </button>
                    <button
                        class="flex items-center justify-center px-4 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors duration-200 text-sm font-medium">
                        <i class="fas fa-calendar-alt mr-2"></i>Agendar Aula
                    </button>
                    <button
                        class="flex items-center justify-center px-4 py-3 bg-amber-500 text-white rounded-lg hover:bg-amber-600 transition-colors duration-200 text-sm font-medium">
                        <i class="fas fa-envelope mr-2"></i>Enviar Lembrete
                    </button>
                </div>
            </div>
        </div>

        <!-- Tables Section -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Students and Instructors Table -->
            <div class="lg:col-span-2 bg-white dark:bg-gray-800 rounded-xl shadow-sm overflow-hidden">
                <div x-data="{ activeTab: 'alunos' }" class="h-full">
                    <!-- Tabs -->
                    <div class="border-b border-gray-200 dark:border-gray-700">
                        <nav class="flex">
                            <button @click="activeTab = 'alunos'" 
                                    :class="{ 'border-b-2 border-indigo-600 text-indigo-600 dark:text-indigo-400': activeTab === 'alunos', 'text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300': activeTab !== 'alunos' }" 
                                    class="px-4 py-3 text-sm font-medium">
                                Alunos
                            </button>
                            <button @click="activeTab = 'instrutores'" 
                                    :class="{ 'border-b-2 border-indigo-600 text-indigo-600 dark:text-indigo-400': activeTab === 'instrutores', 'text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300': activeTab !== 'instrutores' }" 
                                    class="px-4 py-3 text-sm font-medium">
                                Instrutores
                            </button>
                        </nav>
                    </div>

                    <!-- Tab Content -->
                    <div class="p-4">
                        <!-- Students Tab -->
                        <div x-show="activeTab === 'alunos'" class="space-y-4">
                            {% if messages %}
                            {% for message in messages %}
                            <div id="alertBox" class="p-4 mb-4 rounded-lg
                            {% if message.tags == 'success' %}
                                bg-emerald-100 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400
                            {% elif message.tags == 'error' %}
                                bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400
                            {% endif %}">
                                <div class="flex items-center justify-between">
                                    <div class="flex-1">
                                        <strong class="font-medium">{{ message }}</strong>
                                    </div>
                                    <button type="button" class="ml-2" data-bs-dismiss="alert" aria-label="Close">
                                        <span aria-hidden="true">×</span>
                                    </button>
                                </div>
                            </div>
                            {% endfor %}
                            <script>
                                setTimeout(function () {
                                    var alertBox = document.getElementById('alertBox');
                                    if (alertBox) {
                                        alertBox.style.display = 'none';
                                    }
                                }, 3000);
                            </script>
                            {% endif %}

                            <div class="overflow-x-auto scrollbar-thin">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                    <thead class="bg-gray-50 dark:bg-gray-700">
                                        <tr>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Nome</th>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Email</th>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Status</th>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Ações</th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                        {% for aluno in alunos %}
                                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-150">
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <div class="flex items-center">
                                                    <div class="flex-shrink-0 h-10 w-10 rounded-full bg-gray-200 dark:bg-gray-600 flex items-center justify-center">
                                                        <i class="fas fa-user text-gray-500 dark:text-gray-400"></i>
                                                    </div>
                                                    <div class="ml-4">
                                                        <div class="text-sm font-medium text-gray-900 dark:text-white">{{ aluno.nome }}</div>
                                                        <div class="text-sm text-gray-500 dark:text-gray-400">{{ aluno.cpf }}</div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">{{ aluno.email }}</td>
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <span class="status-badge {% if aluno.status == 'Ativo' %}status-active{% else %}status-inactive{% endif %}">
                                                    {{ aluno.status }}
                                                </span>
                                            </td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                                <a href="#" class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-900 dark:hover:text-indigo-300 mr-3">Editar</a>
                                                <a href="#" class="text-red-600 dark:text-red-400 hover:text-red-900 dark:hover:text-red-300">Excluir</a>
                                            </td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Instructors Tab -->
                        <div x-show="activeTab === 'instrutores'" class="space-y-4">
                            <div class="overflow-x-auto scrollbar-thin">
                                <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
                                    <thead class="bg-gray-50 dark:bg-gray-700">
                                        <tr>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Nome</th>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Registro</th>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Função</th>
                                            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Ações</th>
                                        </tr>
                                    </thead>
                                    <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                                        {% for instrutor in instrutores %}
                                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-150">
                                            <td class="px-6 py-4 whitespace-nowrap">
                                                <div class="flex items-center">
                                                    <div class="flex-shrink-0 h-10 w-10 rounded-full bg-gray-200 dark:bg-gray-600 flex items-center justify-center">
                                                        <i class="fas fa-chalkboard-teacher text-gray-500 dark:text-gray-400"></i>
                                                    </div>
                                                    <div class="ml-4">
                                                        <div class="text-sm font-medium text-gray-900 dark:text-white">{{ instrutor.nome }}</div>
                                                        <div class="text-sm text-gray-500 dark:text-gray-400">{{ instrutor.telefone }}</div>
                                                    </div>
                                                </div>
                                            </td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">{{ instrutor.num_confef }}</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400">{{ instrutor.funcao }}</td>
                                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                                <a href="#" class="text-indigo-600 dark:text-indigo-400 hover:text-indigo-900 dark:hover:text-indigo-300 mr-3">Editar</a>
                                                <a href="#" class="text-red-600 dark:text-red-400 hover:text-red-900 dark:hover:text-red-300">Excluir</a>
                                            </td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Filters -->
            <div class="bg-white dark:bg-gray-800 rounded-xl shadow-sm p-6">
                <h3 class="text-lg font-semibold text-gray-800 dark:text-white mb-6">Filtrar Dados</h3>
                <form method="get" action="#" class="space-y-4">
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <div>
                            <label for="filter_status" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label>
                            <select id="filter_status" name="status"
                                class="block w-full border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 sm:text-sm">
                                <option value="">Todos</option>
                                <option value="ativo">Ativo</option>
                                <option value="inativo">Inativo</option>
                            </select>
                        </div>

                        <div>
                            <label for="filter_unidade" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Unidade</label>
                            <select id="filter_unidade" name="unidade"
                                class="block w-full border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 sm:text-sm">
                                <option value="">Todas</option>
                                <option value="porto_alegre">Porto Alegre</option>
                                <option value="caxias">Caxias do Sul</option>
                                <option value="canoas">Canoas</option>
                            </select>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Período de Cadastro</label>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                            <input type="date" name="inicio"
                                class="block w-full border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" />
                            <input type="date" name="fim"
                                class="block w-full border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" />
                        </div>
                    </div>

                    <div>
                        <label for="search_query" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Buscar</label>
                        <input type="text" id="search_query" name="q" placeholder="Digite para buscar..."
                            class="block w-full border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm" />
                    </div>

                    <button type="submit"
                        class="w-full flex items-center justify-center px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors duration-200 text-sm font-medium">
                        <i class="fas fa-search mr-2"></i>Aplicar Filtros
                    </button>
                </form>
            </div>
        </div>
    </main>
</div>
<!-- Modal --> <div id="modalAluno" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50 p-4"> <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 w-full max-w-2xl animate-fade-in-up"> <div class="flex justify-between items-center mb-4"> <h2 class="text-xl font-bold text-gray-800 dark:text-white">Cadastrar Novo Aluno</h2> <button onclick="closeModal('modalAluno')" class="text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 text-2xl"> × </button> </div> <form action="{% url 'cadastrar_aluno' %}" method="post" class="space-y-4"> {% csrf_token %} <div class="grid grid-cols-1 sm:grid-cols-2 gap-4"> <div> <label for="nome" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Nome Completo</label> <input type="text" id="nome" name="nome" required class="block w-full border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 sm:text-sm" /> </div> <div> <label for="cpf" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">CPF</label> <input type="text" id="cpf" name="cpf" required class="block w-full border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 sm:text-sm" /> </div> <div> <label for="email" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Email</label> <input type="email" id="email" name="email" required class="block w-full border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 sm:text-sm" /> </div> <div> <label for="telefone" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Telefone</label> <input type="text" id="telefone" name="telefone" required class="block w-full border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 sm:text-sm" /> </div> <div> <label for="instrutor" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Instrutor</label> <select id="instrutor" name="Cod_instrutor" required class="block w-full border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 sm:text-sm"> <option value="">Selecione um instrutor</option> {% for instrutor in instrutores %} <option value="{{ instrutor.cod_instrutor }}">{{ instrutor.nome }}</option> {% endfor %} </select> </div> <div> <label for="status" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Status</label> <select id="status" name="status" required class="block w-full border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 sm:text-sm"> <option value="Ativo">Ativo</option> <option value="Inativo">Inativo</option> </select> </div> <div> <label for="data_nascimento" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Data de Nascimento</label> <input type="date" id="data_nascimento" name="data_nascimento" required class="block w-full border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 sm:text-sm" /> </div> <div> <label for="sexo" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Sexo</label> <select id="sexo" name="sexo" required class="block w-full border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm py-2 px-3 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 sm:text-sm"> <option value="Masculino">Masculino</option> <option value="Feminino">Feminino</option> <option value="Outro">Outro</option> </select> </div> </div> <div class="mt-6 flex justify-end space-x-3"> <button type="button" onclick="closeModal('modalAluno')" class="px-5 py-2 bg-gray-300 dark:bg-gray-600 rounded-lg hover:bg-gray-400 dark:hover:bg-gray-500 text-gray-800 dark:text-gray-300 font-medium transition-colors duration-200"> Cancelar </button> <button type="submit" class="px-5 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-medium transition-colors duration-200"> Salvar </button> </div> </form> </div> </div>

<script> function openModal(id) { document.getElementById(id).classList.remove("hidden"); document.getElementById(id).classList.add("flex"); }

function closeModal(id) {
    document.getElementById(id).classList.remove("flex");
    document.getElementById(id).classList.add("hidden");
}

// Initialize charts
document.addEventListener('DOMContentLoaded', function() {
    // Status Chart
    const statusCtx = document.getElementById('statusChart').getContext('2d');
    const statusChart = new Chart(statusCtx, {
        type: 'bar',
        data: {
            labels: ['Ativos', 'Inativos'],
            datasets: [{
                label: 'Quantidade de Alunos',
                data: [{{ total_alunos }}, {{ total_inativos }}],
                backgroundColor: [
                    'rgba(16, 185, 129, 0.7)',
                    'rgba(239, 68, 68, 0.7)'
                ],
                borderColor: [
                    'rgba(16, 185, 129, 1)',
                    'rgba(239, 68, 68, 1)'
                ],
                borderWidth: 1,
                borderRadius: 8,
                barThickness: 40
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: false
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: {
                        stepSize: 1
                    },
                    grid: {
                        color: 'rgba(0, 0, 0, 0.05)'
                    }
                },
                x: {
                    grid: {
                        display: false
                    }
                }
            }
        }
    });

    // Revenue Chart
    const revenueCtx = document.getElementById('faturamentoChart').getContext('2d');
    const revenueChart = new Chart(revenueCtx, {
        type: 'line',
        data: {
            labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul'],
            datasets: [{
                label: 'Faturamento (R$)',
                data: [12000, 19000, 15000, 18000, 21000, 19000, 23000],
                fill: true,
                backgroundColor: 'rgba(79, 70, 229, 0.1)',
                borderColor: 'rgba(79, 70, 229, 1)',
                borderWidth: 2,
                tension: 0.4,
                pointBackgroundColor: 'rgba(79, 70, 229, 1)',
                pointRadius: 4,
                pointHoverRadius: 6
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: false
                }
            },
            scales: {
                y: {
                    beginAtZero: false,
                    grid: {
                        color: 'rgba(0, 0, 0, 0.05)'
                    }
                },
                x: {
                    grid: {
                        display: false
                    }
                }
            }
        }
    });
});
</script> {% endblock content %}

